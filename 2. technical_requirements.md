# Technical Requirements Specification

## 1. Functional Specifications (Given-When-Then Format)

1. **Document Creation**
   - *Given* a user with Author role,
   - *When* they upload a draft,
   - *Then* the system shall store it securely and mark status as "Draft".

2. **Approval Workflow**
   - *Given* a document in "Pending" state,
   - *When* an Approver reviews and approves,
   - *Then* the document status shall update to "Approved".

3. **Reader Acknowledgment**
   - *Given* a published document,
   - *When* an Employee marks "Read & Understood",
   - *Then* the system shall log acknowledgment with timestamp and user ID.

4. **Version Control**
   - *Given* an updated version of a document,
   - *When* it is published,
   - *Then* the prior version shall be archived and new version circulated.

5. **Change Management**
   - *Given* an Author creates a Change Memo,
   - *When* it is approved,
   - *Then* the changes shall be appended to audit logs and document updated.

6. **Retention**
   - *Given* a retention policy of 7–10 years,
   - *When* a document exceeds the retention period,
   - *Then* the system shall auto-archive or delete per policy.

7. **E-Signature (Option 2+)**
   - *Given* a document requiring sign-off,
   - *When* integrated with Adobe Sign,
   - *Then* the system shall store signed document and audit reference.

8. **OCR (Option 3)**
   - *Given* a scanned PDF/image uploaded,
   - *When* OCR is applied,
   - *Then* metadata and searchable text shall be indexed.

---

## 2. Architecture Documentation

- **System Pattern**: Modular, service-oriented architecture (SOA).  
- **Frontend**: React or Angular web UI.  
- **Backend**: Laravel (PHP) with REST APIs.  
- **Database**: PostgreSQL / MySQL for structured data.  
- **Storage**: Encrypted file store (cloud or on-prem).  
- **Security**: AES-256 encryption, HTTPS, firewall.  
- **Deployment**:  
  - Cloud: AWS S3 / Azure Blob / Google Cloud.  
  - On-Prem: Secure server with encrypted storage.  
- **Integration**: Adobe Sign API, optional ERP/CRM REST APIs.  

---

## 3. Business Rule Sets

- **BR-001**: No document moves to "Published" without approval.  
- **BR-002**: Max file upload size: 400MB.  
- **BR-003**: Retention policy configurable (7–10 years).  
- **BR-004**: Storage limits tied to tier (50GB → 150GB).  
- **BR-005**: Access is role-based (least privilege).  
- **VAL-001**: All inputs validated for file size, type, metadata integrity.  
- **VAL-002**: All API calls secured with OAuth2.0.  

---

## 4. Data Dictionary (Sample Fields)

| Entity        | Field              | Type        | Constraints                |
|---------------|-------------------|-------------|----------------------------|
| Document      | doc_id            | UUID        | Primary Key                |
|               | title             | String(255) | Required                   |
|               | content           | File Blob   | Encrypted                  |
|               | status            | Enum        | Draft/Pending/Approved     |
|               | retention_date    | Date        | Auto-calculated            |
| User          | user_id           | UUID        | Primary Key                |
|               | name              | String(150) | Required                   |
|               | role              | Enum        | Author/Approver/Reader     |
| Approval      | approval_id       | UUID        | Primary Key                |
|               | doc_id            | UUID        | Foreign Key → Document     |
|               | approver_id       | UUID        | Foreign Key → User         |
| Acknowledgment| ack_id            | UUID        | Primary Key                |
|               | doc_id            | UUID        | Foreign Key → Document     |
|               | user_id           | UUID        | Foreign Key → User         |
| Change Memo   | memo_id           | UUID        | Primary Key                |
|               | doc_id            | UUID        | Foreign Key → Document     |
|               | description       | Text        | Required                   |

---

## 5. Roles & Permissions Matrix

| Role        | Create | Approve | Publish | Read | Configure |
|-------------|--------|---------|---------|------|-----------|
| Author      | Yes    | No      | No      | Yes  | No        |
| Approver    | No     | Yes     | No      | Yes  | No        |
| Publisher   | No     | No      | Yes     | Yes  | No        |
| Employee    | No     | No      | No      | Yes  | No        |
| Admin       | Yes    | Yes     | Yes     | Yes  | Yes       |

---

## 6. Integration Specifications

- **Adobe Sign (Option 2+)**  
  - REST API with OAuth2 authentication.  
  - Workflow: send document → sign → callback → store signed PDF.  

- **ERP/CRM (Option 3)**  
  - REST API integration (SAP, Salesforce).  
  - Authentication: OAuth2/JWT.  
  - Sync metadata, document links.  

- **Cloud Storage (Option 1–3)**  
  - AWS S3, Azure Blob, GCP buckets.  
  - Configurable per client preference.  

---

## 7. Data Migration

- **Source**: Legacy shared drives, existing databases.  
- **Target**: Encrypted DMS repository.  
- **Mapping**: File name → Document entity, folder → Category.  
- **Transformation**: Optional OCR for scanned files (Option 3).  
- **Execution Strategy**: Batch migration with integrity checks, rollback logs.  

---

## 8. Validation Rules

- Input validation: max file size, supported types (doc, pdf, xls, ppt).  
- Business rule validation: approvals required, retention enforced.  
- Security sanitization: strip malicious scripts, enforce MIME types.  

---

## 9. Test Suites

- **Unit Tests**: Document creation, approval workflow, acknowledgment logging.  
- **Integration Tests**: Adobe Sign, OCR, ERP/CRM API calls.  
- **Performance Tests**: 10k concurrent users, retrieval <2s.  
- **Security Tests**: Penetration testing, encryption validation, GDPR compliance.  

---

## 10. Deployment Requirements

- **Infrastructure**:  
  - Cloud: Kubernetes cluster, auto-scaling pods.  
  - On-Prem: Dedicated servers with backup/DR.  

- **Operational Considerations**:  
  - Monitoring with ELK stack / CloudWatch.  
  - Logging of all transactions.  
  - SLA monitoring dashboard.  
